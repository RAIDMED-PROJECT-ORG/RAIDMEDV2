"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5519],{12362:function(e,n,t){var c=t(85893),r=t(86010),s=t(74606),i="info",o="warning",a="error";n.Z=function(e){var n=e.variant,t=void 0===n?i:n,l=e.label,u=e.className,d=e.children,f=(0,r.W)("px-tc20 py-tc10 flex flex-col sm:flex-row gap-tc30 items-center rounded-tc6 justify-center",t===i&&"bg-[#6638F2] text-white ",t===o&&"bg-tcYellow-300 text-tcPurple-900 ",t===a&&"bg-tcRed-300 text-tcPurple-900 ",u&&"".concat(u));return(0,c.jsxs)("div",{className:f,children:[!d&&l&&(0,c.jsx)(s.Tk,{label:l,color:"inherit"}),d]})}},43151:function(e,n,t){t.d(n,{SR:function(){return g},jE:function(){return h},F8:function(){return j}});var c=t(47568),r=t(828),s=t(97582),i=t(85893),o=t(67294),a=t(43528),l=t(68441),u=t(31583),d=t(1604).ZP.string().min(3).max(100).regex(/^[a-zA-Z0-9_ ./!#-]+$/),f=function(e){return!d.safeParse(e).success},v=t(84095),m=t(6822),x=t(61340),h=function(e){var n=e.account;return(0,i.jsx)(a.C3,{className:"mb-tc30",children:(0,i.jsx)(a.gN,{children:(0,i.jsx)(l.o,{className:"text-tcGray-600",disabled:!0,name:"note",readOnly:!0,value:n.name})})})},j=function(e){var n=e.account,t=e.onCopy;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h,{account:n}),(0,i.jsx)(a.C3,{children:(0,i.jsxs)(a.gN,{children:[(0,i.jsx)(a.Qy,{className:"text-tcGray-600 mb-tc10 text-tc15",children:"Access Token"}),(0,i.jsx)(l.o,{password:!0,name:"token",readOnly:!0,value:n.token,copy:!0,onCopy:t,onClick:function(e){e.currentTarget.select(),t()}}),(0,i.jsx)("div",{className:"text-tc15 mt-tc10 ml-tc3",children:"Access Tokens can only be viewed once when they are generated and must be saved securely."})]})}),(0,i.jsx)(u.j,{className:"mt-tc40",color:"warning",label:"Copy your Access Token now, you will not be able to see it again."})]})},g=function(e){var n=e.onAction,t=(0,r.Z)(o.useState(""),2),d=t[0],h=t[1],j=(0,r.Z)(o.useState(),2),g=j[0],p=j[1],b=(0,m.X)(),N=x.d.services.create.useMutation({onSuccess:function(e){"success"!==e.state?p(new Error(e.message)):n(e.account)},onError:function(){p(new Error("Something went wrong, please try again later, we're looking into it"))}}),y=N.mutate,k=N.isLoading;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(a.C3,{children:(0,i.jsxs)(a.gN,{children:[(0,i.jsx)("p",{className:"mb-tc10",children:"The Service Account's name is used to attribute CI usage. It must be unique."}),(0,i.jsxs)("div",{className:"flex justify-between gap-tc10",children:[(0,i.jsx)(l.o,{className:"grow",placeholder:"Account name",name:"note",onChange:function(e){h(e.target.value)}}),(0,i.jsx)(v.r0,{size:"large",color:g?"danger":"default",label:"Create",isDisabled:f(d)||k,isLoading:k,onClick:(0,c.Z)((function(){return(0,s.__generator)(this,(function(e){try{b.track("create_service_account_clicked",{name:d}),y(d),h("")}catch(n){p(n)}return[2]}))}))})]}),(0,i.jsxs)("div",{className:"text-tcRed-600 ml-tc3 mt-tc5",children:[d&&f(d)&&"Please use only alphanumeric symbols, spaces and !#-_./ with length within 3 and 100",g&&(0,i.jsx)(u.j,{color:"danger",label:g.message})]})]})})})}},24135:function(e,n,t){t.d(n,{y:function(){return A},s:function(){return S}});var c=t(828),r=t(29815),s=t(85893),i=t(67294),o=t(25675),a=t.n(o),l=t(10377),u=t(84095);function d(e){var n=e.onClick;return(0,s.jsx)("button",{onClick:n,className:"close-dropdown text-left px-tc10 pt-tc15 pb-tc10 border-t first:border-t-0 hover:text-tcGreen-400 focus:text-tcGreen-400",children:"Regenerate"})}function f(e){var n=e.onClick;return(0,s.jsx)("button",{onClick:n,className:"close-dropdown text-left px-tc10 pt-tc15 pb-tc10 border-t first:border-t-0 border-tcGray-300 hover:text-tcGreen-400 focus:text-tcGreen-400",children:"Delete"})}function v(e){var n=e.canManageServiceAccounts,t=e.onRegenerateClick,c=e.onDeleteClick;return n?(0,s.jsx)(l.J,{position:"bottom-right",trigger:(0,s.jsx)(u.r0,{className:"block p-tc5",variant:"ghost",color:"default",iconName:"dots-vertical",iconOnly:!0}),content:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)(d,{onClick:t}),(0,s.jsx)(f,{onClick:c})]})}):(0,s.jsx)(s.Fragment,{})}var m=t(15741),x=t(34665),h=t(47568),j=t(97582),g=t(37490),p=t(43151),b=t(31583),N=t(61340),y=function(e){var n=e.isOpen,t=e.onClose,r=e.onAction,o=e.account,a=(0,c.Z)(i.useState(),2),l=a[0],d=a[1],f=(0,c.Z)(i.useState(!1),2),v=f[0],m=f[1],x=N.d.services.regenerate.useMutation({onSuccess:function(e){d(e),r(e)}}),y=x.mutate,k=x.isLoading;if((0,i.useEffect)((function(){if(null===l||void 0===l?void 0:l.token){var e=setTimeout((function(){m(!0)}),1e4);return function(){return clearTimeout(e)}}}),[null===l||void 0===l?void 0:l.token]),!o)return(0,s.jsx)(s.Fragment,{});var C=function(){l&&!v||(d(void 0),t())};return(0,s.jsx)(g.z,{isOpen:n,label:"Regenerate Service Account token",content:(0,s.jsxs)("div",{children:[l&&(0,s.jsx)(p.F8,{account:l,onCopy:function(){return m(!0)}}),!l&&(0,s.jsx)(p.jE,{account:o}),!l&&(0,s.jsx)(b.j,{className:"mt-tc20 mb-tc20",color:"danger",label:"Regenerating will invalidate the current token and cannot be undone."}),!l&&(0,s.jsx)(u.r0,{color:"danger",isDisabled:k,isLoading:k,label:"Regenerate",onClick:(0,h.Z)((function(){return(0,j.__generator)(this,(function(e){return y({uid:o.uid}),[2]}))}))}),(0,s.jsx)(u.hE,{className:"justify-end",children:(0,s.jsx)(u.r0,{color:l?"danger":"default",variant:"ghost",isDisabled:l&&!v,label:"Close",onClick:C})})]}),onClose:C})},k=function(e){var n=e.isOpen,t=e.onClose,c=e.onAction,r=e.account,i=N.d.services.delete.useMutation({onSuccess:function(){r&&(c(r),t())}}),o=i.mutate,a=i.isLoading;return r?(0,s.jsx)(g.z,{isOpen:n,label:"Delete Service Account",content:(0,s.jsxs)("div",{children:[(0,s.jsx)(p.jE,{account:r}),(0,s.jsx)(b.j,{color:"danger",label:"Deleting Service Account could not be undone."}),(0,s.jsxs)(u.hE,{className:"justify-end",children:[(0,s.jsx)(u.r0,{variant:"ghost",label:"Cancel",onClick:t}),(0,s.jsx)(u.r0,{color:"danger",label:"Delete",isLoading:a,isDisabled:a,onClick:(0,h.Z)((function(){return(0,j.__generator)(this,(function(e){return o({uid:r.uid}),[2]}))}))})]})]}),onClose:function(){t()}}):(0,s.jsx)(s.Fragment,{})},C=function(e){var n=e.isOpen,t=e.onClose,r=e.onAction,o=(0,c.Z)(i.useState(),2),a=o[0],l=o[1],d=(0,c.Z)(i.useState(!1),2),f=d[0],v=d[1];(0,i.useEffect)((function(){if(null===a||void 0===a?void 0:a.token){var e=setTimeout((function(){v(!0)}),1e4);return function(){return clearTimeout(e)}}}),[null===a||void 0===a?void 0:a.token]);var m=function(){a&&!f||(l(void 0),t())};return(0,s.jsx)(g.z,{isOpen:n,label:"Create new Service Account",content:(0,s.jsxs)("div",{children:[!a&&(0,s.jsx)(p.SR,{onAction:function(e){l(e),r(e)}}),a&&(0,s.jsx)(p.F8,{account:a,onCopy:function(){return v(!0)}}),(0,s.jsx)(u.hE,{className:"justify-end",children:(0,s.jsx)(u.r0,{color:a?"danger":"default",variant:"ghost",label:"Close",onClick:m,isDisabled:!!a&&!f})})]}),onClose:m})},w=t(74606);function S(){var e=(0,c.Z)(i.useState(void 0),2),n=e[0],t=e[1],s=N.d.services.findAll.useQuery(),o=s.data,a=void 0===o?{accounts:[]}:o,l=s.isLoading;(0,i.useEffect)((function(){l||t(a.accounts)}),[a,l]);return{isLoading:l||void 0===n,accounts:n||[],exclude:function(e){t((function(n){return null===n||void 0===n?void 0:n.filter((function(n){return n.uid!==e}))}))},append:function(e){t((function(n){return n?(0,r.Z)(n).concat([e]):[e]}))},replace:function(e){t((function(n){return null===n||void 0===n?void 0:n.map((function(n){return n.uid===e.uid?e:n}))}))}}}var A=function(e){var n=e.canManageServiceAccounts,t=e.isCreateModalOpen,r=e.onCreateModalClose,o=e.serviceAccounts,l=o.accounts,u=o.isLoading,d=o.exclude,f=o.append,h=o.replace,j=(0,c.Z)(i.useState(!1),2),g=j[0],p=j[1],b=(0,c.Z)(i.useState(!1),2),N=b[0],S=b[1],A=(0,c.Z)(i.useState(),2),E=A[0],Z=A[1];return u?(0,s.jsx)("div",{className:"flex items-center justify-center py-tc20",children:(0,s.jsx)(x.O,{variant:"primary"})}):(0,s.jsxs)("div",{children:[(0,s.jsx)(y,{account:n&&E,isOpen:g,onClose:function(){p(!1),Z(void 0)},onAction:function(e){h(e)}}),(0,s.jsx)(k,{account:n&&E,isOpen:N,onClose:function(){S(!1),Z(void 0)},onAction:function(e){d(e.uid)}}),n&&(0,s.jsx)(C,{isOpen:t,onClose:function(){r(),Z(void 0)},onAction:function(e){f(e)}}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-tc25 pt-tc20 pb-tc25 pl-tc15 pr-tc42",children:[(0,s.jsx)(w.Tk,{as:"span",children:"Name"}),(0,s.jsx)(w.Tk,{as:"span",children:"Created"})]}),0===l.length&&(0,s.jsx)("div",{className:"px-tc15 py-tc20 text-center border-t border-tcGray-300",children:"No service accounts"}),(0,s.jsx)("div",{children:l.map((function(e,t){return(0,s.jsxs)("div",{className:"peer grid grid-cols-2 items-center content-center gap-tc25 py-tc20 pl-tc15 pr-tc42 relative border-t last:border-b border-tcGray-300 hover:rounded-tc6 hover:border-transparent focus-within:rounded-tc6 focus-within:border-transparent prev-peer-hover:border-t-transparent prev-peer-focus-within:border-t-transparent hover:bg-tcPurple-100 focus-within:bg-tcPurple-100",children:[(0,s.jsxs)("div",{className:"flex items-center gap-tc10",children:[(0,s.jsx)("div",{className:"h-tc42 aspect-square bg-tcGreen-400 rounded-tc6 overflow-hidden relative shrink-0",children:e.picture?(0,s.jsx)(a(),{className:"absolute inset-0 object-cover",width:"42",height:"42",alt:"",src:e.picture}):(0,s.jsx)("div",{className:"absolute inset-0 object-cover"})}),(0,s.jsx)("div",{className:"truncate",children:(0,s.jsx)(w.Tk,{as:"span",label:e.name,truncate:!0})})]}),(0,s.jsx)("div",{className:"truncate",children:(0,s.jsx)(w.Tk,{as:"span",truncate:!0,children:(0,s.jsx)(m.Z,{format:"local",children:e.createdAt})})}),(0,s.jsx)("div",{className:"absolute right-tc10",children:(0,s.jsx)(v,{canManageServiceAccounts:n,onRegenerateClick:function(){Z(e),p(!0)},onDeleteClick:function(){Z(e),S(!0)}})})]},e.uid)}))})]})}},43528:function(e,n,t){t.d(n,{gN:function(){return r},Qy:function(){return o},C3:function(){return a}});var c=t(85893),r=(t(67294),function(e){var n=e.className,t=e.children,r=[n];return(0,c.jsx)("div",{className:r.join(" "),children:t})}),s=t(86010),i="step",o=function(e){var n=e.className,t=e.name,r=e.variant,o=e.children,a=(0,s.W)("block mb-tc20",r===i&&"text-tc20",n&&n);return(0,c.jsx)("label",{className:a,htmlFor:t,children:o})},a=function(e){var n=e.className,t=e.columns,r=void 0===t?1:t,s=e.children,i=["grid gap-tc20",r?{1:"grid-cols-1",2:"md:grid-cols-2",3:"md:grid-cols-3",4:"md:grid-cols-2 lg:grid-cols-4",5:"md:grid-cols-2 lg:grid-cols-5",6:"md:grid-cols-3 lg:grid-cols-6"}[r]:"",n];return(0,c.jsx)("div",{className:i.join(" "),children:s})}},37490:function(e,n,t){t.d(n,{z:function(){return a}});var c=t(85893),r=t(67294),s=t(48264),i=t(84095),o=t(30650),a=function(e){var n=e.isOpen,t=e.onClose,a=void 0===t?function(){}:t,l=e.label,u=e.content,d=e.disabled,f=(0,r.useRef)(null),v="\n        a[href],\n        area[href],\n        input:not([disabled]),\n        button:not([disabled]),\n        select:not([disabled]),\n        textarea:not([disabled]),\n        iframe,\n        object,\n        embed,\n        *[tabindex]:not([disabled]),\n        *[contenteditable=true]\n    ",m=function(e){if("Tab"==e.key&&f.current){var n=f.current.querySelectorAll(v),t=n[0],c=n[n.length-1];document.activeElement===t&&e.shiftKey?(e.preventDefault(),c.focus()):document.activeElement!==c||e.shiftKey||(e.preventDefault(),t.focus())}};(0,r.useEffect)((function(){n&&n&&f.current&&f.current.querySelectorAll(v)[0].focus()}),[n,v]);var x=function(e){var n=e.key;d||"Escape"!==n||a()};return(0,r.useEffect)((function(){if(n)return document.addEventListener("keydown",x),document.addEventListener("keydown",m),function(){document.removeEventListener("keydown",x),document.removeEventListener("keydown",m)}})),n?(0,c.jsxs)("div",{ref:f,className:"fixed inset-0 z-50 grid items-center justify-items-center overflow-y-auto p-tc30",children:[(0,c.jsx)("div",{className:"fixed inset-0 backdrop-blur",onClick:d?void 0:a}),(0,c.jsxs)("div",{className:"relative bg-white border ".concat(o.Vq," rounded-tc6 p-tc25 shadow-tcModal w-full max-w-[47rem]"),children:[(0,c.jsxs)("div",{className:"flex items-center justify-center border-b ".concat(o.Vq," pb-tc20 mb-tc30"),children:[(0,c.jsx)(s.r,{as:"h3",label:l}),(0,c.jsx)(i.r0,{className:"ml-auto",iconName:"x",iconOnly:!0,variant:"ghost",onClick:d?void 0:a})]}),(0,c.jsx)("div",{children:u})]})]}):(0,c.jsx)(c.Fragment,{})}},15741:function(e,n,t){var c=t(85893),r=(t(67294),t(69695)),s=t.n(r);n.Z=function(e){var n=e.children,t=e.format,r=e.className;if(!n)return(0,c.jsx)("div",{className:r,children:"Never"});var i=Date.parse(n),o=Date.now()-i;switch(t){case"local":return(0,c.jsx)("span",{className:r,children:new Date(i).toLocaleString()});case"since":return o<1e4?(0,c.jsx)("span",{className:r,children:"just now"}):o<6e4?(0,c.jsx)("span",{className:r,children:"less than a minute ago"}):(0,c.jsxs)("span",{className:r,children:[s()(o,{delimiter:" ",largest:2,units:["mo","w","d","h","m"],round:!0})," ago"]});case"in":return(0,c.jsxs)("span",{className:r,children:["in ",s()(o,{delimiter:" ",largest:2,units:["y","mo","w","d","h","m"],round:!0})]});default:return(0,c.jsx)("span",{className:r,children:n})}}}}]);